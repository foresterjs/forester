<link rel="import" href="../app-theme/app-theme.html">
<link rel="import" href="part-collections.html">

<dom-module id="app-boot">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <h1>Forester explorer</h1>

    <part-collections collections="{{collections}}"></part-collections>

  </template>
</dom-module>

<script>
  Polymer({

    is: 'app-boot',

    attached: function () {

      function status(response) {
        if (response.status >= 200 && response.status < 300) {
          return Promise.resolve(response)
        } else {
          return Promise.reject(new Error(response.statusText))
        }
      }

      function json (response) {
        return response.json()
      }


      fetch('/schema')
        .then(status)
        .then(json)
        .then(function(data) {
          console.log('Request succeeded with JSON response', data);
          this.collections = Object.keys(data).map(function (key) { return data[key]; })
        }.bind(this))
        .catch(function(error) {
          console.log('Request failed', error);
        });
    }

  });
</script>