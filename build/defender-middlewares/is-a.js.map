{"version":3,"sources":["../../lib/defender-middlewares/is-a.js"],"names":[],"mappings":"AAAA;;;;AAEA,OAAO,OAAP,GAAiB,UAAU,IAAV,EAAgB;;AAE/B;AAAA,yDAAO,wBAAkC,IAAlC;AAAA,UAAiB,IAAjB,SAAiB,IAAjB;AAAA,UAAuB,QAAvB,SAAuB,QAAvB;AAAA,UAOD,KAPC,EAQD,YARC,EAUD,KAVC;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEA,IAFA;AAAA;AAAA;AAAA;;AAGH,uBAAS,MAAT,GAAkB,GAAlB;AAHG;;AAAA;AAOD,mBAPC,GAOO,KAAK,KAAL,IAAc,EAPrB;AAQD,0BARC,GAQc,KAAK,KARnB;AAUD,mBAVC,GAUO,aAAa,IAAb,CAAkB,UAAC,IAAD;AAAA,uBAAW,MAAM,OAAN,CAAc,IAAd,KAAuB,CAAlC;AAAA,eAAlB,CAVP;;AAAA,kBAYA,KAZA;AAAA;AAAA;AAAA;;AAaH,uBAAS,MAAT,GAAkB,GAAlB;AAbG;;AAAA;AAAA;AAAA,qBAkBC,MAlBD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAqBD,CAvBD","file":"is-a.js","sourcesContent":["\"use strict\";\n\nmodule.exports = function (rule) {\n\n  return async function ({user, response}, next) {\n\n    if (!user) {\n      response.status = 403;\n      return;\n    }\n\n    var roles = user.roles || [];\n    var allowedRoles = rule.roles;\n\n    var allow = allowedRoles.some((role) => (roles.indexOf(role) >= 0));\n\n    if (!allow) {\n      response.status = 403;\n      return;\n    }\n\n\n    await next();\n\n  }\n};\n"]}