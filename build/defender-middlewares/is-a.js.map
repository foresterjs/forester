{"version":3,"sources":["../../lib/defender-middlewares/is-a.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;AAEb,MAAM,CAAC,OAAO,GAAG,UAAU,IAAI,EAAE;;AAE/B;gCAAO,iBAAkC,IAAI,EAAE;UAAvB,IAAI,QAAJ,IAAI;UAAE,QAAQ,QAAR,QAAQ;;AAEpC,UAAI,CAAC,IAAI,EAAE;AACT,gBAAQ,CAAC,MAAM,GAAG,GAAG,CAAC;AACtB,eAAO;OACR;;AAED,UAAI,KAAK,GAAG,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;AAC7B,UAAI,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC;;AAE9B,UAAI,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,UAAC,IAAI;eAAM,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC;OAAC,CAAC,CAAC;;AAEpE,UAAI,CAAC,KAAK,EAAE;AACV,gBAAQ,CAAC,MAAM,GAAG,GAAG,CAAC;AACtB,eAAO;OACR;;AAGD,YAAM,IAAI,EAAE,CAAC;KAEd;;;;;OAAA;CACF,CAAC","file":"is-a.js","sourcesContent":["\"use strict\";\n\nmodule.exports = function (rule) {\n\n  return async function ({user, response}, next) {\n\n    if (!user) {\n      response.status = 403;\n      return;\n    }\n\n    var roles = user.roles || [];\n    var allowedRoles = rule.roles;\n\n    var allow = allowedRoles.some((role) => (roles.indexOf(role) >= 0));\n\n    if (!allow) {\n      response.status = 403;\n      return;\n    }\n\n\n    await next();\n\n  }\n};\n"]}