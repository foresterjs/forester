{"version":3,"sources":["../../lib/defender-middlewares/is-a.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;AAEb,MAAM,CAAC,OAAO,GAAG,UAAU,IAAI,EAAE;;AAE/B;wDAAO,uBAAkC,IAAI;UAArB,IAAI,QAAJ,IAAI;UAAE,QAAQ,QAAR,QAAQ;UAOhC,KAAK,EACL,YAAY,EAEZ,KAAK;;;;;kBARJ,IAAI;;;;;AACP,sBAAQ,CAAC,MAAM,GAAG,GAAG,CAAC;;;;AAIpB,mBAAK,GAAG,IAAI,CAAC,KAAK,IAAI,EAAE;AACxB,0BAAY,GAAG,IAAI,CAAC,KAAK;AAEzB,mBAAK,GAAG,YAAY,CAAC,IAAI,CAAC,UAAC,IAAI;uBAAM,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC;eAAC,CAAC;;kBAE9D,KAAK;;;;;AACR,sBAAQ,CAAC,MAAM,GAAG,GAAG,CAAC;;;;;qBAKlB,IAAI,EAAE;;;;;;;;KAEb;;;;;OAAA;CACF,CAAC","file":"is-a.js","sourcesContent":["\"use strict\";\n\nmodule.exports = function (rule) {\n\n  return async function ({user, response}, next) {\n\n    if (!user) {\n      response.status = 403;\n      return;\n    }\n\n    var roles = user.roles || [];\n    var allowedRoles = rule.roles;\n\n    var allow = allowedRoles.some((role) => (roles.indexOf(role) >= 0));\n\n    if (!allow) {\n      response.status = 403;\n      return;\n    }\n\n\n    await next();\n\n  }\n};\n"]}