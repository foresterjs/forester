{"version":3,"sources":["../../lib/rest-middlewares/common.js"],"names":[],"mappings":"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","file":"common.js","sourcesContent":["\"use strict\";\n\nexport function showSchema({collection}) {\n  return async function ({request, response, params}, next) {\n\n    response.body = response.body || {};\n\n    var schema = collection.schema;\n\n    response.body.schema = {\n      name: schema.name,\n      description: schema.description,\n      properties: schema.properties,\n      relations: schema.relations\n    };\n\n    await next();\n  }\n}\n\nexport function showCount({collection}) {\n  return async function ({request, response, params}, next) {\n\n    response.body = response.body || {};\n\n    response.body.collectionCount = await collection.count();\n\n    await next();\n  }\n}\n\nexport function showPagesCount({collection}) {\n  return async function ({request, response, params}, next) {\n\n    var query = request.query || {};\n\n    response.body = response.body || {};\n\n    var count;\n    if(query.hasOwnProperty(\"where\")){\n      count = await collection.count(query.where);\n    }else{\n      count = response.body.collectionCount;\n    }\n\n    var perPage = request.query.perPage || collection.defaults.perPage;\n\n    response.body.pages = Math.ceil(count / perPage);\n    response.body.count = count;\n\n    await next();\n  }\n}\n\nexport function showUser({collection}) {\n  return async function ({request, response, user}, next) {\n\n    response.body = response.body || {};\n\n    response.body.user = user;\n\n    await next();\n  }\n}\n"]}